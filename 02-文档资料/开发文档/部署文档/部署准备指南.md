# éƒ¨ç½²å‡†å¤‡æŒ‡å—

## ğŸ“‹ éƒ¨ç½²å‰æ£€æŸ¥æ¸…å•

### 1. ä»£ç è´¨é‡æ£€æŸ¥

```bash
cd "/Users/luyu/CascadeProjects/Sandyçš„AIæ”¶è—å¤¹/01-æºä»£ç /ç½‘ç«™ä»£ç "

# ç±»å‹æ£€æŸ¥
npm run type-check

# ä»£ç è§„èŒƒæ£€æŸ¥
npm run lint

# ä»£ç æ ¼å¼åŒ–æ£€æŸ¥
npm run format:check

# å®Œæ•´æ£€æŸ¥
npm run check
```

### 2. æ„å»ºæµ‹è¯•

```bash
# æ¸…ç†ä¹‹å‰çš„æ„å»º
rm -rf .next .contentlayer

# æ‰§è¡Œç”Ÿäº§æ„å»º
npm run build

# æœ¬åœ°æµ‹è¯•ç”Ÿäº§ç‰ˆæœ¬
npm start
```

è®¿é—® http://localhost:3002 éªŒè¯ç”Ÿäº§ç‰ˆæœ¬æ˜¯å¦æ­£å¸¸ã€‚

### 3. ç¯å¢ƒå˜é‡æ£€æŸ¥

æ£€æŸ¥æ˜¯å¦éœ€è¦é…ç½®ç¯å¢ƒå˜é‡ï¼š

- [ ] æ•°æ®åº“è¿æ¥ï¼ˆå¦‚æœæœ‰ï¼‰
- [ ] API å¯†é’¥ï¼ˆå¦‚æœæœ‰ï¼‰
- [ ] ç¬¬ä¸‰æ–¹æœåŠ¡é…ç½®ï¼ˆå¦‚æœæœ‰ï¼‰
- [ ] å›¾ç‰‡ CDN é…ç½®ï¼ˆå¦‚æœæœ‰ï¼‰

### 4. å†…å®¹æ–‡ä»¶æ£€æŸ¥

ç¡®ä¿ä»¥ä¸‹å†…å®¹æ–‡ä»¶å­˜åœ¨ä¸”æ ¼å¼æ­£ç¡®ï¼š

- [ ] `å†…å®¹/å…¬å¼€å†…å®¹/å‘¨æŠ¥/` - å‘¨æŠ¥æ–‡ä»¶
- [ ] `å†…å®¹/å…¬å¼€å†…å®¹/æ–°é—»/` - æ–°é—»æ–‡ä»¶
- [ ] `å†…å®¹/å…¬å¼€å†…å®¹/ç¬”è®°/` - ç¬”è®°æ–‡ä»¶
- [ ] `å†…å®¹/å…¬å¼€å†…å®¹/é¡µé¢/` - é¡µé¢æ–‡ä»¶

### 5. é™æ€èµ„æºæ£€æŸ¥

- [ ] `public/` ç›®å½•ä¸‹çš„é™æ€èµ„æº
- [ ] å›¾ç‰‡æ–‡ä»¶è·¯å¾„æ­£ç¡®
- [ ] å­—ä½“æ–‡ä»¶ï¼ˆå¦‚æœæœ‰ï¼‰

---

## ğŸš€ éƒ¨ç½²æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1: Vercel éƒ¨ç½²ï¼ˆæ¨èï¼‰

Vercel æ˜¯ Next.js çš„å®˜æ–¹æ¨èå¹³å°ï¼Œå¯¹ Next.js + Contentlayer æœ‰å¾ˆå¥½çš„æ”¯æŒã€‚

#### å‡†å¤‡å·¥ä½œ

1. **GitHub ä»“åº“å‡†å¤‡**
   - ç¡®ä¿ä»£ç å·²æ¨é€åˆ° GitHub
   - ç¡®ä¿ `.gitignore` æ­£ç¡®é…ç½®ï¼ˆæ’é™¤ `.contentlayer/`ã€`node_modules/` ç­‰ï¼‰

2. **Vercel è´¦å·**
   - è®¿é—® https://vercel.com
   - ä½¿ç”¨ GitHub è´¦å·ç™»å½•

#### éƒ¨ç½²æ­¥éª¤

1. **å¯¼å…¥é¡¹ç›®**
   - åœ¨ Vercel Dashboard ç‚¹å‡» "Add New Project"
   - é€‰æ‹©ä½ çš„ GitHub ä»“åº“
   - é€‰æ‹©ä»“åº“ä¸­çš„ `01-æºä»£ç /ç½‘ç«™ä»£ç ` ç›®å½•ä½œä¸ºæ ¹ç›®å½•

2. **é…ç½®é¡¹ç›®è®¾ç½®**

   **Root Directory**: `01-æºä»£ç /ç½‘ç«™ä»£ç `

   **Build Command**: 
   ```bash
   npm run build
   ```

   **Output Directory**: `.next` (é»˜è®¤)

   **Install Command**: 
   ```bash
   npm install
   ```

3. **ç¯å¢ƒå˜é‡**ï¼ˆå¦‚æœéœ€è¦ï¼‰
   - åœ¨ Vercel é¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ç¯å¢ƒå˜é‡
   - ä¾‹å¦‚ï¼š`NODE_ENV=production`

4. **éƒ¨ç½²**
   - ç‚¹å‡» "Deploy"
   - ç­‰å¾…æ„å»ºå®Œæˆï¼ˆé€šå¸¸ 2-5 åˆ†é’Ÿï¼‰
   - æ„å»ºæˆåŠŸåä¼šè‡ªåŠ¨åˆ†é…ä¸€ä¸ªåŸŸå

#### Vercel é…ç½®æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰

åˆ›å»º `vercel.json` åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼š

```json
{
  "buildCommand": "npm run build",
  "devCommand": "npm run dev",
  "installCommand": "npm install",
  "framework": "nextjs",
  "regions": ["hkg1"]
}
```

#### Contentlayer åœ¨ Vercel ä¸Šçš„å¤„ç†

Vercel ä¼šè‡ªåŠ¨å¤„ç† Contentlayerï¼š
- æ„å»ºæ—¶ä¼šè‡ªåŠ¨è¿è¡Œ `contentlayer build`
- `.contentlayer/` ç›®å½•ä¼šåœ¨æ„å»ºæ—¶ç”Ÿæˆ
- ä¸éœ€è¦é¢å¤–é…ç½®

---

### æ–¹æ¡ˆ 2: è‡ªå»ºæœåŠ¡å™¨éƒ¨ç½²

#### æœåŠ¡å™¨è¦æ±‚

- Node.js 18+ 
- npm æˆ– yarn
- è‡³å°‘ 1GB RAM
- æ”¯æŒ Node.js çš„æœåŠ¡å™¨ï¼ˆå¦‚ Ubuntuã€CentOSï¼‰

#### éƒ¨ç½²æ­¥éª¤

1. **æœåŠ¡å™¨å‡†å¤‡**

```bash
# å®‰è£… Node.js (ä½¿ç”¨ nvm)
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
nvm install 18
nvm use 18

# å®‰è£… PM2 (è¿›ç¨‹ç®¡ç†)
npm install -g pm2
```

2. **ä»£ç éƒ¨ç½²**

```bash
# å…‹éš†ä»“åº“
git clone <your-repo-url>
cd "Sandyçš„AIæ”¶è—å¤¹/01-æºä»£ç /ç½‘ç«™ä»£ç "

# å®‰è£…ä¾èµ–
npm install --production

# æ„å»ºé¡¹ç›®
npm run build
```

3. **å¯åŠ¨æœåŠ¡**

```bash
# ä½¿ç”¨ PM2 å¯åŠ¨
pm2 start npm --name "sandy-ai-collection" -- start

# æˆ–è€…ç›´æ¥å¯åŠ¨
npm start
```

4. **é…ç½® Nginxï¼ˆåå‘ä»£ç†ï¼‰**

```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://localhost:3002;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
```

5. **é…ç½® SSLï¼ˆHTTPSï¼‰**

ä½¿ç”¨ Let's Encryptï¼š

```bash
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d your-domain.com
```

---

### æ–¹æ¡ˆ 3: Docker éƒ¨ç½²

#### Dockerfile

åˆ›å»º `Dockerfile` åœ¨ `01-æºä»£ç /ç½‘ç«™ä»£ç /` ç›®å½•ï¼š

```dockerfile
FROM node:18-alpine AS base

# å®‰è£…ä¾èµ–
FROM base AS deps
WORKDIR /app
COPY package*.json ./
RUN npm ci

# æ„å»ºåº”ç”¨
FROM base AS builder
WORKDIR /app
COPY --from=deps /app/node_modules ./node_modules
COPY . .
RUN npm run build

# ç”Ÿäº§é•œåƒ
FROM base AS runner
WORKDIR /app

ENV NODE_ENV production

RUN addgroup --system --gid 1001 nodejs
RUN adduser --system --uid 1001 nextjs

COPY --from=builder /app/public ./public
COPY --from=builder --chown=nextjs:nodejs /app/.next/standalone ./
COPY --from=builder --chown=nextjs:nodejs /app/.next/static ./.next/static

USER nextjs

EXPOSE 3002

ENV PORT 3002
ENV HOSTNAME "0.0.0.0"

CMD ["node", "server.js"]
```

#### docker-compose.yml

```yaml
version: '3.8'

services:
  web:
    build: .
    ports:
      - "3002:3002"
    environment:
      - NODE_ENV=production
    restart: unless-stopped
```

#### éƒ¨ç½²å‘½ä»¤

```bash
# æ„å»ºé•œåƒ
docker build -t sandy-ai-collection .

# è¿è¡Œå®¹å™¨
docker run -p 3002:3002 sandy-ai-collection

# æˆ–ä½¿ç”¨ docker-compose
docker-compose up -d
```

---

## âš™ï¸ éƒ¨ç½²é…ç½®ä¼˜åŒ–

### 1. Next.js è¾“å‡ºé…ç½®

å¦‚æœéœ€è¦é™æ€å¯¼å‡ºï¼ˆå®Œå…¨é™æ€ç«™ç‚¹ï¼‰ï¼Œä¿®æ”¹ `next.config.js`ï¼š

```javascript
const nextConfig = {
  output: 'export', // é™æ€å¯¼å‡º
  // æ³¨æ„ï¼šä½¿ç”¨é™æ€å¯¼å‡ºæ—¶ï¼ŒæŸäº›åŠŸèƒ½ä¼šå—é™ï¼ˆå¦‚ API Routesï¼‰
}
```

### 2. å›¾ç‰‡ä¼˜åŒ–é…ç½®

ç¡®ä¿ `next.config.js` ä¸­çš„å›¾ç‰‡é…ç½®é€‚åˆç”Ÿäº§ç¯å¢ƒï¼š

```javascript
images: {
  formats: ['image/avif', 'image/webp'],
  deviceSizes: [640, 750, 828, 1080, 1200],
  imageSizes: [16, 32, 48, 64, 96, 128, 256],
  unoptimized: false,
}
```

### 3. ç¯å¢ƒå˜é‡é…ç½®

åˆ›å»º `.env.production`ï¼ˆä¸è¦æäº¤åˆ° Gitï¼‰ï¼š

```bash
NODE_ENV=production
NEXT_PUBLIC_SITE_URL=https://your-domain.com
```

### 4. æ„å»ºä¼˜åŒ–

åœ¨ `package.json` ä¸­æ·»åŠ æ„å»ºä¼˜åŒ–è„šæœ¬ï¼š

```json
{
  "scripts": {
    "build": "next build",
    "build:analyze": "ANALYZE=true next build",
    "postbuild": "next-sitemap"
  }
}
```

---

## ğŸ” éƒ¨ç½²åéªŒè¯

### 1. åŠŸèƒ½æ£€æŸ¥

- [ ] é¦–é¡µæ­£å¸¸åŠ è½½
- [ ] å‘¨æŠ¥åˆ—è¡¨æ˜¾ç¤ºæ­£å¸¸
- [ ] å‘¨æŠ¥è¯¦æƒ…é¡µæ­£å¸¸
- [ ] ç¬”è®°é¡µé¢æ­£å¸¸
- [ ] å…³äºé¡µé¢æ­£å¸¸
- [ ] ç®¡ç†é¡µé¢æ­£å¸¸ï¼ˆå¦‚æœéƒ¨ç½²ï¼‰

### 2. æ€§èƒ½æ£€æŸ¥

- [ ] é¡µé¢åŠ è½½é€Ÿåº¦ < 3ç§’
- [ ] å›¾ç‰‡åŠ è½½æ­£å¸¸
- [ ] ç§»åŠ¨ç«¯æ˜¾ç¤ºæ­£å¸¸
- [ ] SEO æ ‡ç­¾æ­£ç¡®

### 3. é”™è¯¯ç›‘æ§

å»ºè®®é›†æˆé”™è¯¯ç›‘æ§æœåŠ¡ï¼š

- **Sentry**: https://sentry.io
- **LogRocket**: https://logrocket.com
- **Vercel Analytics**: Vercel å†…ç½®

---

## ğŸ“ éƒ¨ç½²æ¸…å•æ€»ç»“

### éƒ¨ç½²å‰

- [ ] ä»£ç é€šè¿‡ç±»å‹æ£€æŸ¥
- [ ] ä»£ç é€šè¿‡è§„èŒƒæ£€æŸ¥
- [ ] æœ¬åœ°æ„å»ºæˆåŠŸ
- [ ] æœ¬åœ°ç”Ÿäº§ç‰ˆæœ¬æµ‹è¯•é€šè¿‡
- [ ] ç¯å¢ƒå˜é‡é…ç½®å®Œæˆ
- [ ] å†…å®¹æ–‡ä»¶å®Œæ•´

### éƒ¨ç½²ä¸­

- [ ] é€‰æ‹©éƒ¨ç½²å¹³å°ï¼ˆVercel/è‡ªå»º/Dockerï¼‰
- [ ] é…ç½®æ„å»ºå‘½ä»¤
- [ ] é…ç½®ç¯å¢ƒå˜é‡
- [ ] ç­‰å¾…æ„å»ºå®Œæˆ

### éƒ¨ç½²å

- [ ] è®¿é—®ç½‘ç«™éªŒè¯åŠŸèƒ½
- [ ] æ£€æŸ¥æ€§èƒ½æŒ‡æ ‡
- [ ] é…ç½®åŸŸåï¼ˆå¦‚æœéœ€è¦ï¼‰
- [ ] é…ç½® SSL è¯ä¹¦ï¼ˆHTTPSï¼‰
- [ ] è®¾ç½®é”™è¯¯ç›‘æ§
- [ ] é…ç½®è‡ªåŠ¨éƒ¨ç½²ï¼ˆCI/CDï¼‰

---

## ğŸ†˜ å¸¸è§é—®é¢˜

### 1. Contentlayer æ„å»ºå¤±è´¥

**é—®é¢˜**: æ„å»ºæ—¶ Contentlayer æŠ¥é”™

**è§£å†³**:
- æ£€æŸ¥ `contentlayer.config.ts` é…ç½®
- ç¡®ä¿å†…å®¹æ–‡ä»¶è·¯å¾„æ­£ç¡®
- æ£€æŸ¥ YAML frontmatter æ ¼å¼

### 2. å›¾ç‰‡åŠ è½½å¤±è´¥

**é—®é¢˜**: ç”Ÿäº§ç¯å¢ƒå›¾ç‰‡æ— æ³•åŠ è½½

**è§£å†³**:
- æ£€æŸ¥å›¾ç‰‡è·¯å¾„ï¼ˆä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼‰
- ç¡®ä¿å›¾ç‰‡åœ¨ `public/` ç›®å½•
- æ£€æŸ¥ `next.config.js` ä¸­çš„å›¾ç‰‡é…ç½®

### 3. è·¯ç”± 404

**é—®é¢˜**: æŸäº›é¡µé¢è¿”å› 404

**è§£å†³**:
- æ£€æŸ¥ `generateStaticParams` æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥è·¯ç”±æ–‡ä»¶å‘½å
- æ£€æŸ¥ `next.config.js` ä¸­çš„ rewrites é…ç½®

### 4. æ„å»ºæ—¶é—´è¿‡é•¿

**é—®é¢˜**: Vercel æ„å»ºè¶…æ—¶

**è§£å†³**:
- ä¼˜åŒ– Contentlayer é…ç½®
- å‡å°‘é™æ€ç”Ÿæˆé¡µé¢æ•°é‡
- ä½¿ç”¨å¢é‡é™æ€ç”Ÿæˆï¼ˆISRï¼‰

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Next.js éƒ¨ç½²æ–‡æ¡£](https://nextjs.org/docs/deployment)
- [Vercel éƒ¨ç½²æŒ‡å—](https://vercel.com/docs)
- [Contentlayer æ–‡æ¡£](https://www.contentlayer.dev/docs)
- [Docker éƒ¨ç½² Next.js](https://nextjs.org/docs/deployment#docker-image)

