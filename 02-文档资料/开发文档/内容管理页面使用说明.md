# 内容管理页面使用说明

## 概述

内容管理页面提供了一个可视化的 Web 界面，用于从 Obsidian 知识库的表格中解析内容，并手动选择需要同步到网站的条目。

## 访问地址

开发环境：`http://localhost:3002/管理`

## 功能特性

- ✅ 可视化配置 Obsidian 路径和表格文件
- ✅ 解析 Markdown 表格并显示所有条目
- ✅ 手动选择/取消选择条目（复选框）
- ✅ 搜索和筛选条目
- ✅ 批量操作（全选/取消全选）
- ✅ 执行同步（只同步选中的条目）
- ✅ 显示同步结果和统计信息

## 使用步骤

### 1. 配置 Obsidian 路径

1. 打开内容管理页面：`http://localhost:3002/管理`
2. 在"Obsidian 知识库路径"输入框中填写你的 Obsidian 知识库的绝对路径
   - 在 Obsidian 中查找路径：设置 → 文件与链接 → 查看"库文件夹位置"
   - 示例：`/Users/username/Documents/ObsidianVault`
3. 在"表格文件名"输入框中填写包含表格的 Markdown 文件名
   - 示例：`内容索引.md`

### 2. 解析表格

1. 点击"解析表格"按钮
2. 系统会读取并解析表格文件
3. 解析成功后，会在下方显示所有条目列表

### 3. 选择条目

1. 使用复选框选择需要同步的条目
2. 可以使用"全选/取消全选"按钮批量操作
3. 使用搜索框搜索特定条目（支持搜索标题、路径、日期、标签等）

### 4. 执行同步

1. 确认已选择需要同步的条目（页面顶部会显示选中数量）
2. 点击"执行同步"按钮
3. 等待同步完成
4. 查看同步结果（成功/失败统计）

## 表格格式要求

Obsidian 表格需要包含以下列：

| 文件路径 | 日期 | 标题 | 标签 | 评分 | 摘要 | 来源 |
|---------|------|------|------|------|------|------|
| 公开内容/新闻/文章1.md | 2025-01-06 | 文章标题 | AI,商业 | 9.5 | 摘要内容 | - |

### 必需列

- **文件路径** (或 filePath, file_path): 相对于 Obsidian 知识库的文件路径
- **日期** (或 date): 日期，支持格式：YYYY-MM-DD, YYYY/MM/DD, YYYY.MM.DD

### 可选列

- **标题** (或 title)
- **标签** (或 tags): 逗号或空格分隔
- **评分** (或 score): 数字
- **摘要** (或 summary)
- **来源** (或 source)

## 界面说明

### 配置区域

- **Obsidian 知识库路径**: 输入 Obsidian 知识库的绝对路径
- **表格文件名**: 输入包含表格的 Markdown 文件名
- **解析表格按钮**: 点击后解析表格并显示条目

### 条目列表区域

- **搜索框**: 搜索标题、路径、日期、标签等
- **全选/取消全选按钮**: 批量选择或取消选择所有条目
- **执行同步按钮**: 同步选中的条目到项目
- **条目卡片**: 
  - 复选框：选择/取消选择
  - 标题：条目标题或文件路径
  - 文件路径：显示文件的相对路径
  - 元信息：日期、标签、评分、来源等
  - 摘要：条目摘要（如果有）

### 同步结果区域

- **成功状态**: 显示绿色背景，包含同步统计信息
- **失败状态**: 显示红色背景，包含错误信息

## 注意事项

1. **路径格式**: Obsidian 路径必须使用绝对路径
2. **文件权限**: 确保应用有读取 Obsidian 知识库和写入项目内容目录的权限
3. **表格格式**: 确保表格格式正确，包含必需的列
4. **文件存在**: 表格中列出的文件必须真实存在于 Obsidian 知识库中
5. **同步目标**: 文件会同步到项目的 `内容/` 目录，保持原有目录结构

## 故障排查

### 问题 1: 解析失败

**错误**: "表格文件不存在" 或 "未找到表格"

**解决方案**:
- 检查 Obsidian 路径是否正确（使用绝对路径）
- 检查表格文件名是否正确
- 确认表格文件确实存在于 Obsidian 知识库中
- 确认表格格式正确（使用 `|` 分隔）

### 问题 2: 同步失败

**错误**: "文件不存在" 或 "同步失败"

**解决方案**:
- 检查表格中的文件路径是否正确
- 确认文件确实存在于 Obsidian 知识库中
- 检查项目内容目录的写入权限

### 问题 3: 页面无法访问

**解决方案**:
- 确认开发服务器正在运行：`npm run dev`
- 确认访问地址正确：`http://localhost:3002/管理`
- 检查浏览器控制台是否有错误信息

## 技术实现

### API 路由

- `/管理/api/parse-table` - 解析表格
- `/管理/api/sync` - 执行同步

### 数据流

```
用户输入配置
  ↓
调用 parse-table API
  ↓
解析表格，返回条目列表
  ↓
用户选择条目
  ↓
调用 sync API
  ↓
同步选中的文件到项目
  ↓
返回同步结果
```

## 相关文档

- [Obsidian 表格筛选系统](../../04-脚本工具/内容筛选/README.md)
- [项目迭代计划](../需求文档/项目迭代计划.md)





